# Chặn kết nối vào và ra với từ khóa "ultraviewer"
$rules = @(
    "Block Ultraviewer Outbound",
    "Block Ultraviewer Inbound"
)

# Thêm quy tắc chặn vào Windows Firewall
foreach ($rule in $rules) {
    if ($rule -like "*Outbound*") {
        New-NetFirewallRule -DisplayName $rule -Direction Outbound -Action Block -RemoteAddress "ultraviewer.net"
        New-NetFirewallRule -DisplayName $rule -Direction Outbound -Action Block -RemoteAddress "www.ultraviewer.net"
    } else {
        New-NetFirewallRule -DisplayName $rule -Direction Inbound -Action Block -RemoteAddress "ultraviewer.net"
        New-NetFirewallRule -DisplayName $rule -Direction Inbound -Action Block -RemoteAddress "www.ultraviewer.net"
    }
}

# Chỉnh sửa tệp hosts
$hostsPath = "C:\Windows\System32\drivers\etc\hosts"
$entries = @(
    "127.0.0.1 ultraviewer.net",
    "127.0.0.1 www.ultraviewer.net"
)

foreach ($entry in $entries) {
    if (-not (Select-String -Path $hostsPath -Pattern $entry)) {
        Add-Content -Path $hostsPath -Value $entry
    }
}

Write-Host "Chặn kết nối vào và ra với từ khóa 'ultraviewer' đã hoàn tất."
